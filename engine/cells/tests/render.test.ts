import { describe, it } from "node:test";
import assert from "node:assert";

import { renderNumber } from "../render.ts";

describe("renderNumber", () => {
    const eq = (v: number, expected: string) => {
        const actual = renderNumber(v);
        assert.deepStrictEqual(
            actual,
            expected,
            `Expected renderNumber(${v}) to be ${expected}, got ${actual}`,
        );
    };

    eq(0.0, "0");
    eq(-0.0, "0");

    eq(1e2, "100");
    eq(1e1, "10");
    eq(1, "1");
    eq(1e-1, "0.1");
    eq(1e-2, "0.01");
    eq(1e-3, "0.001");
    eq(1e-4, "0.0001");
    eq(1e-5, "0.00001");
    eq(1e-6, "0.000001");
    eq(1e-7, "1e-7");
    eq(1e-8, "1e-8");
    eq(1e-9, "1e-9");
    eq(1e-10, "1e-10");

    eq(2e2, "200");
    eq(2e1, "20");
    eq(2, "2");
    eq(2e-1, "0.2");
    eq(2e-2, "0.02");
    eq(2e-3, "0.002");
    eq(2e-4, "0.0002");
    eq(2e-5, "0.00002");
    eq(2e-6, "0.000002");
    eq(2e-7, "2e-7");
    eq(2e-8, "2e-8");
    eq(2e-9, "2e-9");
    eq(2e-10, "2e-10");

    eq(-1e2, "-100");
    eq(-1e1, "-10");
    eq(-1, "-1");
    eq(-1e-1, "-0.1");
    eq(-1e-2, "-0.01");
    eq(-1e-3, "-0.001");
    eq(-1e-4, "-0.0001");
    eq(-1e-5, "-0.00001");
    eq(-1e-6, "-0.000001");
    eq(-1e-7, "-1e-7");
    eq(-1e-8, "-1e-8");
    eq(-1e-9, "-1e-9");
    eq(-1e-10, "-1e-10");

    eq(-2e2, "-200");
    eq(-2e1, "-20");
    eq(-2, "-2");
    eq(-2e-1, "-0.2");
    eq(-2e-2, "-0.02");
    eq(-2e-3, "-0.002");
    eq(-2e-4, "-0.0002");
    eq(-2e-5, "-0.00002");
    eq(-2e-6, "-0.000002");
    eq(-2e-7, "-2e-7");
    eq(-2e-8, "-2e-8");
    eq(-2e-9, "-2e-9");
    eq(-2e-10, "-2e-10");

    eq(0.100000000000001, "0.1");
    eq(0.10000000000001, "0.1");
    eq(0.1000000000001, "0.1");
    eq(0.100000000001, "0.1");
    eq(0.10000000001, "0.1");
    eq(0.1000000001, "0.1");
    eq(0.100000001, "0.1");
    eq(0.10000001, "0.1");
    eq(0.1000001, "0.1");

    eq(0.100001, "0.100001");
});
